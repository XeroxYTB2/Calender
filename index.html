<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calendrier de l'Avent</title>
<style>
    body {
        background:#0f3f36;
        font-family: Arial, sans-serif;
        display:flex;
        flex-direction:column;
        align-items:center;
        padding:20px;
        color:white;
    }

    h1 { margin-bottom:20px; }

    #calendar {
        display:grid;
        grid-template-columns: repeat(6, 150px);
        grid-gap:15px;
    }

    .day {
        width:150px;
        height:120px;
        background:#b42222;
        color:white;
        border-radius:10px;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        cursor:pointer;
        font-size:20px;
        transition:0.3s;
        border:3px solid #8c1e1e;
    }

    .opened {
        background:#e4d32b;
        color:black;
        border:3px solid #c7b924;
    }

    .label {
        font-size:14px;
        margin-top:6px;
    }

    #resetBtn {
        margin-top:30px;
        padding:10px 20px;
        font-size:18px;
        border:none;
        border-radius:8px;
        background:#d9534f;
        color:white;
        cursor:pointer;
        transition:0.3s;
    }

    #resetBtn:hover {
        background:#c9302c;
    }

    /* ----------------------------- */
    /*      POPUP (style Snapchat)   */
    /* ----------------------------- */

    #popupOverlay {
        position: fixed;
        top:0; left:0;
        width:100%; height:100%;
        background: rgba(0,0,0,0.55);
        backdrop-filter: blur(4px);
        display:flex;
        align-items:center;
        justify-content:center;
        visibility:hidden;
        opacity:0;
        transition:0.25s;
        z-index:1000;
    }

    #popupOverlay.active {
        visibility: visible;
        opacity:1;
    }

    #popupBox {
        background:white;
        color:black;
        width:300px;
        padding:20px;
        border-radius:18px;
        text-align:center;
        box-shadow:0 8px 25px rgba(0,0,0,0.4);
        transform:scale(0.8);
        transition:0.25s;
    }

    #popupOverlay.active #popupBox {
        transform:scale(1);
    }

    #popupMessage {
        font-size:18px;
        margin-bottom:20px;
    }

    .popupBtn {
        padding:10px 15px;
        font-size:16px;
        border:none;
        border-radius:10px;
        cursor:pointer;
        margin:5px;
    }

    .btnConfirm {
        background:#4CAF50;
        color:white;
    }

    .btnCancel {
        background:#d9534f;
        color:white;
    }
</style>
</head>

<body>

<h1>üéÑ Calendrier de l'Avent üéÑ</h1>

<div id="calendar"></div>
<button id="resetBtn">Annuler la derni√®re ouverture</button>

<!-- POPUP PERSONALIS√âE -->
<div id="popupOverlay">
    <div id="popupBox">
        <div id="popupMessage"></div>
        <div id="popupButtons"></div>
    </div>
</div>

<script>
// ---------------------------
// Gestion de pop-ups custom
// ---------------------------
function showPopup(message, buttons = []) {
    const overlay = document.getElementById("popupOverlay");
    const msgBox = document.getElementById("popupMessage");
    const btnBox = document.getElementById("popupButtons");

    msgBox.textContent = message;
    btnBox.innerHTML = "";

    buttons.forEach(btn => {
        const b = document.createElement("button");
        b.textContent = btn.text;
        b.className = "popupBtn " + (btn.class || "");
        b.onclick = () => {
            overlay.classList.remove("active");
            if (btn.action) btn.action();
        };
        btnBox.appendChild(b);
    });

    overlay.classList.add("active");
}

// ---------------------------
// 1. G√©n√©ration dynamique
// ---------------------------
const calendar = document.getElementById("calendar");

let openedDays = JSON.parse(localStorage.getItem("openedDays")) || [];

function createCalendar() {
    calendar.innerHTML = "";

    for (let i = 1; i <= 24; i++) {
        const div = document.createElement("div");
        div.classList.add("day");
        div.dataset.day = i;
        div.innerHTML = `
            <div>‚≠ê</div>
            <div>${i}</div>
            <div class="label">${openedDays.includes(i) ? "D√©j√† ouverte üéÅ" : "√Ä ouvrir üéÑ"}</div>
        `;

        if (openedDays.includes(i)) div.classList.add("opened");

        div.onclick = () => openDay(i, div);

        calendar.appendChild(div);
    }
}

// ---------------------------
// 2. Ouverture d‚Äôune case
// ---------------------------
function openDay(day, element) {
    showPopup("üéÅ Tu as ouvert la case " + day + " !", [
        { text:"OK", class:"btnConfirm" }
    ]);

    if (!openedDays.includes(day)) {
        openedDays.push(day);
        localStorage.setItem("openedDays", JSON.stringify(openedDays));
    }

    element.classList.add("opened");
    element.querySelector(".label").textContent = "D√©j√† ouverte üéÅ";
}

// ---------------------------
// 3. Reset = retire derni√®re case
// ---------------------------
document.getElementById("resetBtn").onclick = () => {

    if (openedDays.length === 0) {
        showPopup("‚ùó Aucune case ouverte √† annuler.", [
            { text:"OK", class:"btnConfirm" }
        ]);
        return;
    }

    const last = openedDays[openedDays.length - 1];

    showPopup("‚ùì Annuler l‚Äôouverture de la case " + last + " ?", [
        {
            text:"Oui",
            class:"btnConfirm",
            action: () => {
                openedDays.pop();
                localStorage.setItem("openedDays", JSON.stringify(openedDays));
                createCalendar();
            }
        },
        {
            text:"Non",
            class:"btnCancel"
        }
    ]);
};

// ---------------------------
// Initialisation
// ---------------------------
createCalendar();
</script>

</body>
</html>
